<% if application_choices_with_accepted_states.present? %>
  <table class="govuk-table govuk-!-margin-top-0">
    <caption class="govuk-table__caption govuk-heading-m">Successful applications</caption>
    <tbody class="govuk-table__body">
    <% application_choices_with_accepted_states.each do |application_choice| %>
      <tr class="govuk-table__row" data-qa="application-choice-<%= application_choice.id %>">
        <td class="govuk-table__cell govuk-!-width-two-thirds">
          <span class="app-course-choice__course-name">
          <%= govuk_link_to candidate_interface_application_review_submitted_path(application_choice.application_form.id) do %>
            <%= application_choice.current_course.name%>
            <% end %>
          </span>
          <span class="app-course-choice__provider-name govuk-caption-m govuk-!-font-weight-regular">
            <%= application_choice.provider.name %>
          </span>
        </td>
        <td class="govuk-table__cell">
          <%= render CandidateInterface::ApplicationStatusTagComponent.new(application_choice: application_choice) %>
          <% if withdrawable?(application_choice)%>
            <%= render CandidateInterface::CourseChoicesSummaryCardActionComponent.new(action: :withdraw, application_choice: application_choice)%>
          <% elsif application_choice.offer? %>
            <%= render CandidateInterface::CourseChoicesSummaryCardActionComponent.new(action: :respond_to_offer, application_choice: application_choice)%>
          <% end %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>

<% if application_choices_with_offer.present? %>
  <table class="govuk-table govuk-!-margin-top-0">
    <caption class="govuk-table__caption govuk-heading-m">Applications awaiting your action</caption>
    <tbody class="govuk-table__body">
    <% application_choices_with_offer.each do |application_choice| %>
      <tr class="govuk-table__row" data-qa="application-choice-<%= application_choice.id %>">
        <td class="govuk-table__cell govuk-!-width-two-thirds">
          <span class="app-course-choice__course-name">
          <%= govuk_link_to candidate_interface_application_review_submitted_path(application_choice.application_form.id) do %>
            <%= application_choice.current_course.name%>
            <% end %>
          </span>
          <span class="app-course-choice__provider-name govuk-caption-m govuk-!-font-weight-regular">
            <%= application_choice.provider.name %>
          </span>
        </td>
        <td class="govuk-table__cell">
          <%= render CandidateInterface::ApplicationStatusTagComponent.new(application_choice: application_choice) %>
          <% if withdrawable?(application_choice)%>
            <%= render CandidateInterface::CourseChoicesSummaryCardActionComponent.new(action: :withdraw, application_choice: application_choice)%>
          <% elsif application_choice.offer? %>
            <%= render CandidateInterface::CourseChoicesSummaryCardActionComponent.new(action: :respond_to_offer, application_choice: application_choice)%>
          <% end %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>

<% if application_choices_awaiting_provider_decision.present? %>
  <table class="govuk-table govuk-!-margin-top-0">
    <caption class="govuk-table__caption govuk-heading-m">Applications awaiting provider action</caption>
    <tbody class="govuk-table__body">
    <% application_choices_awaiting_provider_decision.each do |application_choice| %>
      <tr class="govuk-table__row" data-qa="application-choice-<%= application_choice.id %>">
        <td class="govuk-table__cell govuk-!-width-two-thirds">
          <span class="app-course-choice__course-name">
          <%= govuk_link_to candidate_interface_application_review_submitted_path(application_choice.application_form.id) do %>
            <%= application_choice.current_course.name%>
            <% end %>
          </span>
          <span class="app-course-choice__provider-name govuk-caption-m govuk-!-font-weight-regular">
            <%= application_choice.provider.name %>
          </span>
        </td>
        <td class="govuk-table__cell">
          <%= render CandidateInterface::ApplicationStatusTagComponent.new(application_choice: application_choice) %>
          <% if withdrawable?(application_choice)%>
            <%= render CandidateInterface::CourseChoicesSummaryCardActionComponent.new(action: :withdraw, application_choice: application_choice)%>
          <% elsif application_choice.offer? %>
            <%= render CandidateInterface::CourseChoicesSummaryCardActionComponent.new(action: :respond_to_offer, application_choice: application_choice)%>
          <% end %>
        </td>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>

<% if show_missing_banner? %>
  <%= render(CandidateInterface::IncompleteSectionComponent.new(section: :course_choices, section_path: candidate_interface_course_choices_index_path, error: @missing_error)) %>
<% end %>
