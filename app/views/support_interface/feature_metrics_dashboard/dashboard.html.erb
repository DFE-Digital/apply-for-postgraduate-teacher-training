<% content_for :title, 'Feature metrics' %>

<h2 class="govuk-heading-m govuk-!-font-size-27 govuk-!-margin-top-8">References</h2>
<div id="references_dashboard_section" class="govuk-grid-row govuk-!-margin-bottom-4">
  <div class="govuk-grid-column-one-half">
    <div id="headline-stat" class="govuk-!-margin-bottom-4">
      <%= render SupportInterface::TileComponent.new(
        count: @reference_statistics.average_time_to_get_references(
          EndOfCycleTimetable.apply_reopens.beginning_of_day,
        ),
        label: 'average time to get reference back',
        colour: :blue,
        size: :reduced,
      ) %>
    </div>
    <div class="govuk-grid-row govuk-!-margin-bottom-4">
      <div class="govuk-grid-column-one-half">
        <%= render SupportInterface::TileComponent.new(
          count: @reference_statistics.average_time_to_get_references(
            Time.zone.now.beginning_of_month,
          ),
          label: 'this month',
          size: :reduced,
        ) %>
      </div>
      <div class="govuk-grid-column-one-half">
        <%= render SupportInterface::TileComponent.new(
          count: @reference_statistics.average_time_to_get_references(
            Time.zone.now.beginning_of_month - 1.month,
            Time.zone.now.beginning_of_month,
          ),
          label: 'last month',
          size: :reduced,
        ) %>
      </div>
    </div>
  </div>

  <div class="govuk-grid-column-one-half">
    <div id="headline-stat" class="govuk-!-margin-bottom-4">
      <%= render SupportInterface::TileComponent.new(
        count: @reference_statistics.percentage_references_within(
          30,
          EndOfCycleTimetable.apply_reopens.beginning_of_day,
        ),
        label: 'completed within 30 days',
        colour: :blue,
        size: :reduced,
      ) %>
    </div>
    <div class="govuk-grid-row govuk-!-margin-bottom-4">
      <div class="govuk-grid-column-one-half">
        <%= render SupportInterface::TileComponent.new(
          count: @reference_statistics.percentage_references_within(
            30,
            Time.zone.now.beginning_of_month,
          ),
          label: 'this month',
          size: :reduced,
        ) %>
      </div>
      <div class="govuk-grid-column-one-half">
        <%= render SupportInterface::TileComponent.new(
          count: @reference_statistics.percentage_references_within(
            30,
            Time.zone.now.beginning_of_month - 1.month,
            Time.zone.now.beginning_of_month,
          ),
          label: 'last month',
          size: :reduced,
        ) %>
      </div>
    </div>
  </div>
</div>

<h3 class="govuk-heading-m govuk-!-font-size-27 govuk-!-margin-top-8">Work history</h3>
<div id="work_history_dashboard_section" class="govuk-grid-row govuk-!-margin-bottom-4">
  <div class="govuk-grid-column-one-half">
    <div id="headline-stat" class="govuk-!-margin-bottom-4">
      <%= render SupportInterface::TileComponent.new(
        count: nil,
        label: 'time to complete (days)',
        colour: :blue,
        size: :reduced,
      ) %>
    </div>
    <div class="govuk-grid-row govuk-!-margin-bottom-4">
      <div class="govuk-grid-column-one-half">
        <%= render SupportInterface::TileComponent.new(
          count: @work_history_statistics.average_time_to_complete(
            EndOfCycleTimetable.apply_reopens.beginning_of_day,
          ),
          label: 'this cycle',
          size: :reduced,
        ) %>
      </div>
      <div class="govuk-grid-column-one-half">
        <%= render SupportInterface::TileComponent.new(
          count: @work_history_statistics.average_time_to_complete(
            1.month.ago.beginning_of_day,
          ),
          label: 'last month',
          size: :reduced,
        ) %>
      </div>
    </div>
  </div>
</div>
